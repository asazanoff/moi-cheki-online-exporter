# Автоматическое получение чеков из сервиса "Мои чеки онлайн"

Как-то так получилось, что подрядчики ФНС разработали две программы со схожим функционалом: **Мои чеки онлайн** -- веб версия, и мобильное приложение **Проверка чека**. При этом в **Мои чеки онлайн** загружаются все чеки, которые привязаны к почтам и номерам телефонов пользователей, а в мобильном приложении -- не все. Почему так получается - непонятно. Однако мобильное приложение имеет функцию выгрузки чеков за период в JSON, что актуально для автоматической загрузки чеков в различные программы для ведения личного финансового учета, а веб-версия такой возможности не имеет.

Программа автоматизированно получает чеки из **Мои чеки онлайн** и выгружает QR-коды чеков и JSON в виде, схожем в выгрузке из мобильного приложения **Проверка чека**.

В решении используется Docker Compose для сборки и запуска сервисов.

## Переменные окружения backend-части

Переменные могут быть заданы в `.env`-файле. В качестве примера приведен `.env.example`

Предполагается, что вы зарегистрированы и уже вошли в **Мои чеки онлайн** в настольном браузере.

- `REFRESH_TOKEN` -- рефреш токен. Использутся для получения и обновления аксесс токена. Можно получить в локальном хранилище https://lkdr.nalog.ru. Поле `refresh.token`.
- `DEBUG_MODE` -- расширенный вывод в stdout. Используйте при тестировании и первом запуске приложения.
- `FNS_API_URL` -- URL сервиса API **Мои чеки онлайн**. Можно проверить в режиме разработчика, куда браузер отправляет запросы на веб-странице.
- `APP_DOMAIN` -- локальный домен сервиса. Нужен для аннотаций в traefik. Пропустите, если не используете traefik, и вам достаточно экспозить порт.
- `FNS_DEVICE_ID` -- идентификатор устройства. Можно получить в локальном хранилище https://lkdr.nalog.ru. Поле `sourceDeviceId`.
- `USER_AGENT` -- юзерагент устройства. Участвует в получении аксесс-токена. Не факт, что его значение важно.

